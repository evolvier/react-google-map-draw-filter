!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.GoogleMapDrawFilter=e()}}(function(){return function e(t,n,o){function r(i,l){if(!n[i]){if(!t[i]){var p="function"==typeof require&&require;if(!l&&p)return p(i,!0);if(a)return a(i,!0);var s=new Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){var n=t[i][1][e];return r(n?n:e)},u,u.exports,e,t,n,o)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<o.length;i++)r(o[i]);return r}({1:[function(e,t,n){t.exports=function(e,t){for(var n=e[0],o=e[1],r=!1,a=0,i=t.length-1;a<t.length;i=a++){var l=t[a][0],p=t[a][1],s=t[i][0],u=t[i][1],f=p>o!=u>o&&n<(s-l)*(o-p)/(u-p)+l;f&&(r=!r)}return r}},{}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){e=e||{};var t=e.apiKey,n=e.libraries||[],o=e.client,r="https://maps.googleapis.com/maps/api/js",a="3.25",i=(window.google=null,null),l=null,p=null,s=function u(){var u=r,e={key:t,callback:"CALLBACK_NAME",libraries:n.join(","),client:o,v:a,channel:i,language:l,region:p},s=Object.keys(e).filter(function(t){return!!e[t]}).map(function(t){return t+"="+e[t]}).join("&");return u+"?"+s};return s()};n.GoogleApi=o,n["default"]=o},{}],3:[function(e,t,n){(function(t){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=function(e,t,n){for(var o=!0;o;){var r=e,a=t,i=n;o=!1,null===r&&(r=Function.prototype);var l=Object.getOwnPropertyDescriptor(r,a);if(void 0!==l){if("value"in l)return l.value;var p=l.get;if(void 0===p)return;return p.call(i)}var s=Object.getPrototypeOf(r);if(null===s)return;e=s,t=a,n=i,o=!0,l=s=void 0}},p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},s="undefined"!=typeof window?window.React:"undefined"!=typeof t?t.React:null,u=o(s),f=e("react-dom"),c=o(f),d=e("./ScriptCache"),g=o(d),y=e("./GoogleApi"),h=o(y),v={},m=function(e){var t=function(t){function n(e,t){r(this,n),l(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,e,t),this.state={loaded:!1,map:null,google:null}}return a(n,t),i(n,[{key:"componentDidMount",value:function(){var e=this,t=this.refs;this.scriptCache.google.onLoad(function(n,o){try{var r=window.google.maps,a=(p({},e.props,{loaded:e.state.loaded}),t.map),i=c["default"].findDOMNode(a),l=new r.LatLng(e.props.lat,e.props.lng),s=p({},v,{center:l,zoom:e.props.zoom});e.map=new r.Map(i,s),e.setState({loaded:!0,map:e.map,google:window.google})}catch(u){window.location.reload(),console.log("react-google-map-draw-filter is reloading page to get google window, in next release this should be fixed")}})}},{key:"componentWillMount",value:function(){this.scriptCache=(0,g["default"])({google:(0,h["default"])({apiKey:this.props.apiKey,libraries:["drawing"]})})}},{key:"render",value:function(){var t=p({},this.props,{loaded:this.state.loaded,map:this.state.map,google:this.state.google,mapComponent:this.refs.map});return u["default"].createElement("div",null,u["default"].createElement(e,t),u["default"].createElement("div",{ref:"map"}))}}]),n}(u["default"].Component);return t};n.wrapper=m,n["default"]=m}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./GoogleApi":2,"./ScriptCache":4,"react-dom":void 0}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=0,r=new Map,a=function(e){return function(t){var n={};return n._onLoad=function(e){return function(t){var n=r.get(e);n&&n.promise.then(function(){n.error?t(n.error):t(null,n)})}},n._scriptTag=function(t,n){return r.has(t)||!function(){var a=document.createElement("script"),i=new Promise(function(i,l){var p=document.getElementsByTagName("body")[0];a.type="text/javascript",a.async=!1;var s="loaderCB"+o++ +Date.now(),u=void 0,f=function(){e[s]&&"function"==typeof e[s]&&(e[s]=null)},c=function(e){return function(o){var a=r.get(t);"loaded"===e?(a.resolved=!0,i(n)):"error"===e&&(a.errored=!0,l(o)),f()}};return a.onload=c("loaded"),a.onerror=c("error"),a.onreadystatechange=function(){c(a.readyState)},n.match(/callback=CALLBACK_NAME/)?(n=n.replace(/(callback=)[^\&]+/,"$1"+s),u=window[s]=a.onload):a.addEventListener("load",a.onload),a.addEventListener("error",a.onerror),a.src=n,p.appendChild(a),a}),l={loaded:!1,error:!1,promise:i,tag:a};r.set(t,l)}(),r.get(t)},Object.keys(t).forEach(function(e){var o=t[e];n[e]={tag:n._scriptTag(e,o),onLoad:n._onLoad(e)}}),n}}(window);n.ScriptCache=a,n["default"]=a},{}],5:[function(e,t,n){(function(o){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),p=function(e,t,n){for(var o=!0;o;){var r=e,a=t,i=n;o=!1,null===r&&(r=Function.prototype);var l=Object.getOwnPropertyDescriptor(r,a);if(void 0!==l){if("value"in l)return l.value;var p=l.get;if(void 0===p)return;return p.call(i)}var s=Object.getPrototypeOf(r);if(null===s)return;e=s,t=a,n=i,o=!0,l=s=void 0}},s="undefined"!=typeof window?window.React:"undefined"!=typeof o?o.React:null,u=r(s),f=e("./ApiComponents/ScriptCache"),c=(r(f),e("./ApiComponents/GoogleApi")),d=(r(c),e("./ApiComponents/GoogleApiComponent")),g=r(d),y=e("./Map"),h=r(y),v=function(e){function t(){a(this,t),p(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return i(t,e),l(t,[{key:"render",value:function(){return u["default"].createElement("div",null,u["default"].createElement(h["default"],{google:this.props.google,drawMode:this.props.drawMode,markers:this.props.markers,mapConfig:this.props.mapConfig,mapStyle:this.props.mapStyle,polygonOptions:this.props.polygonOptions,handleReturnedMarkers:this.props.handleReturnedMarkers,onMarkerClick:this.props.onMarkerClick,insertMarker:this.props.insertMarker,apiKey:this.props.apiKey}))}}]),t}(u["default"].Component);v.propTypes={apiKey:u["default"].PropTypes.string.isRequired,drawMode:u["default"].PropTypes.bool,markers:u["default"].PropTypes.array,mapConfig:u["default"].PropTypes.object,polygonOptions:u["default"].PropTypes.object,google:u["default"].PropTypes.object,mapStyle:u["default"].PropTypes.object,handleReturnedMarkers:u["default"].PropTypes.func,onMarkerClick:u["default"].PropTypes.func,insertMarker:u["default"].PropTypes.bool},v.defaultProps={drawMode:!0,insertMarker:!1,mapConfig:{zoom:14,lat:41.384279176844764,lng:2.1526336669921875},mapStyle:{height:"600px",width:"600px"},polygonOptions:{fillColor:"#455A64",fillOpacity:.3,strokeColor:"#455A64",strokeWeight:3,clickable:!0,editable:!0,zIndex:1},markers:[]},n["default"]=(0,g["default"])(v),t.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ApiComponents/GoogleApi":2,"./ApiComponents/GoogleApiComponent":3,"./ApiComponents/ScriptCache":4,"./Map":6}],6:[function(e,t,n){(function(o){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),p=function(e,t,n){for(var o=!0;o;){var r=e,a=t,i=n;o=!1,null===r&&(r=Function.prototype);var l=Object.getOwnPropertyDescriptor(r,a);if(void 0!==l){if("value"in l)return l.value;var p=l.get;if(void 0===p)return;return p.call(i)}var s=Object.getPrototypeOf(r);if(null===s)return;e=s,t=a,n=i,o=!0,l=s=void 0}},s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},u="undefined"!=typeof window?window.React:"undefined"!=typeof o?o.React:null,f=r(u),c=e("react-dom"),d=r(c),g=e("point-in-polygon"),y=r(g),h=[],v=function(e){function t(){a(this,t),p(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.state={drawMode:!1,loaded:!1}}return i(t,e),l(t,[{key:"componentDidUpdate",value:function(e,t){e.google!==this.props.google&&(this.loadMap(),this.props.drawMode&&this.drawPolyline(),this.props.insertMarker&&this.insertMarker()),e.markers.length!==this.props.markers.length&&this.markers!=e.markers&&this.state.loaded&&this.getMarkers()}},{key:"componentWillReceiveProps",value:function(e){this.props.google;this.props.drawMode!==e.drawMode&&e.drawMode&&this.props.google&&this.drawPolyline()}},{key:"insertMarker",value:function(){var e=this.props.google,t=e.maps;e.maps.event.addListener(this.map,"click",function(n){var o=this,r={position:new e.maps.LatLng(n.latLng.lat(),n.latLng.lng()),map:this.map,draggable:!0},a=new t.Marker(r);this.props.handleReturnedMarkers({lat:n.latLng.lat(),lng:n.latLng.lng()}),a.addListener("dragend",function(e){o.props.handleReturnedMarkers({lat:e.latLng.lat(),lng:e.latLng.lng()})})}.bind(this))}},{key:"drawPolyline",value:function(){var e=this.props.google,t=new e.maps.drawing.DrawingManager({drawingMode:e.maps.drawing.OverlayType.POLYGON,drawingControl:!1,polygonOptions:this.props.polygonOptions});t.setMap(this.map),e.maps.event.addListener(t,"polygoncomplete",function(n){var o=this;t.setDrawingMode(null);var r=n.getPath();e.maps.event.addListener(n,"click",function(e){n.setMap(null),r=[],o.getMarkers(),o.drawPolyline()});var a=function(){var e=[],t=[];r.forEach(function(t){e.push([t.lat(),t.lng()])}),h.forEach(function(n){var r=n.getPosition().lat(),a=n.getPosition().lng();(0,y["default"])([r,a],e)?(t.push(n),n.map||n.setMap(o.map)):n.setMap(null)}),o.props.handleReturnedMarkers&&o.props.handleReturnedMarkers(t)};a(),e.maps.event.addListener(r,"set_at",function(e){r=n.getPath(),a()}),e.maps.event.addListener(r,"insert_at",function(e){r=n.getPath(),a()})}.bind(this))}},{key:"getMarkers",value:function(){var e=this,t=this.props.google,n=t.maps;h.forEach(function(e){e.setMap(null)}),h=[],this.props.markers.forEach(function(o){var r=s({},o,{position:new t.maps.LatLng(o.latLng.lat,o.latLng.lng),map:e.map}),a=new n.Marker(r);e.props.onMarkerClick&&t.maps.event.addListener(a,"click",function(t){e.props.onMarkerClick(a)}),a.info&&!function(){var n=new t.maps.InfoWindow({content:a.info});t.maps.event.addListener(a,"click",function(t){n.open(e.map,a)})}(),h.push(a),e.props.handleReturnedMarkers&&e.props.handleReturnedMarkers(h)})}},{key:"loadMap",value:function(){var e=this,t=this.props.google,n=t.maps,o=this.refs.map,r=d["default"].findDOMNode(o),a=this.props.mapConfig,i=a.zoom,l=a.lat,p=a.lng,u=new n.LatLng(l,p),f=s({},{center:u,zoom:i});this.map=new n.Map(r,f),t.maps.event.addListenerOnce(this.map,"idle",function(){e.getMarkers()}),this.setState({loaded:!0})}},{key:"render",value:function(){return f["default"].createElement("div",{style:this.props.mapStyle,ref:"map"},"Loading map...")}}]),t}(f["default"].Component);n["default"]=v,t.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"point-in-polygon":1,"react-dom":void 0}]},{},[5])(5)});